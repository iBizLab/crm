# 服务插件 <!-- {docsify-ignore-all} -->

|  对象      |  实体  |  类型  | 插件  |备注|
|  --------  | ----- | -----    |-----    |----    |
|@内容||PSSysTranslatorImpl|[SysAtContentTranslatorRuntime](#UsrSFPlugin0201416283)||
|Get|[客户(ACCOUNT)](module/crm/account)|PSDEBuiltinActionImpl|[（通用）获取并生成最近访问](#GetAndCreateRecent)||
|批添加标签(add_tags)|[客户(ACCOUNT)](module/crm/account)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[客户(ACCOUNT)](module/crm/account)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[客户(ACCOUNT)](module/crm/account)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[客户(ACCOUNT)](module/crm/account)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[客户(ACCOUNT)](module/crm/account)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[通话(CALL)](module/crm/call)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[通话(CALL)](module/crm/call)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[通话(CALL)](module/crm/call)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[通话(CALL)](module/crm/call)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[通话(CALL)](module/crm/call)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[市场活动(CAMPAIGN)](module/crm/campaign)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[市场活动(CAMPAIGN)](module/crm/campaign)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[市场活动(CAMPAIGN)](module/crm/campaign)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[市场活动(CAMPAIGN)](module/crm/campaign)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[市场活动(CAMPAIGN)](module/crm/campaign)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[服务支持(CASE)](module/crm/service_case)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[服务支持(CASE)](module/crm/service_case)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[服务支持(CASE)](module/crm/service_case)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[服务支持(CASE)](module/crm/service_case)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[服务支持(CASE)](module/crm/service_case)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[联系人(CONTACT)](module/crm/contact)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[联系人(CONTACT)](module/crm/contact)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[联系人(CONTACT)](module/crm/contact)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[联系人(CONTACT)](module/crm/contact)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[联系人(CONTACT)](module/crm/contact)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[商机(DEAL)](module/crm/deal)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[商机(DEAL)](module/crm/deal)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[商机(DEAL)](module/crm/deal)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[商机(DEAL)](module/crm/deal)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[商机(DEAL)](module/crm/deal)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[会议(EVENT)](module/crm/event)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[会议(EVENT)](module/crm/event)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[会议(EVENT)](module/crm/event)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[会议(EVENT)](module/crm/event)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[会议(EVENT)](module/crm/event)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[发货单(INVOICE)](module/crm/invoice)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[发货单(INVOICE)](module/crm/invoice)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[发货单(INVOICE)](module/crm/invoice)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[发货单(INVOICE)](module/crm/invoice)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[发货单(INVOICE)](module/crm/invoice)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|Get|[线索(LEAD)](module/crm/lead)|PSDEBuiltinActionImpl|[（通用）获取并生成最近访问](#GetAndCreateRecent)||
|批添加标签(add_tags)|[线索(LEAD)](module/crm/lead)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[线索(LEAD)](module/crm/lead)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[线索(LEAD)](module/crm/lead)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[线索(LEAD)](module/crm/lead)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[线索(LEAD)](module/crm/lead)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|树表格(tree)|[线索(LEAD)](module/crm/lead)|PSDEDataSetImpl|[TreeGridDEDataSetRuntime](#UsrSFPlugin0407757309)||
|批添加标签(add_tags)|[活动(MANEUVER)](module/crm/maneuver)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[活动(MANEUVER)](module/crm/maneuver)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[活动(MANEUVER)](module/crm/maneuver)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[活动(MANEUVER)](module/crm/maneuver)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[活动(MANEUVER)](module/crm/maneuver)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[收款记录(PAYEE)](module/crm/payee)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[收款记录(PAYEE)](module/crm/payee)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[收款记录(PAYEE)](module/crm/payee)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[收款记录(PAYEE)](module/crm/payee)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[收款记录(PAYEE)](module/crm/payee)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[收款计划(PAYEE_PLAN)](module/crm/payee_plan)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[收款计划(PAYEE_PLAN)](module/crm/payee_plan)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[收款计划(PAYEE_PLAN)](module/crm/payee_plan)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[收款计划(PAYEE_PLAN)](module/crm/payee_plan)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[收款计划(PAYEE_PLAN)](module/crm/payee_plan)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[价格表(PRICE_BOOK)](module/crm/price_book)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[价格表(PRICE_BOOK)](module/crm/price_book)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[价格表(PRICE_BOOK)](module/crm/price_book)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[价格表(PRICE_BOOK)](module/crm/price_book)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[价格表(PRICE_BOOK)](module/crm/price_book)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[产品(PRODUCT)](module/crm/product)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[产品(PRODUCT)](module/crm/product)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[产品(PRODUCT)](module/crm/product)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[产品(PRODUCT)](module/crm/product)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[产品(PRODUCT)](module/crm/product)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[产品证书(PRODUCT_CERTIFICATE)](module/crm/product_certificate)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[产品证书(PRODUCT_CERTIFICATE)](module/crm/product_certificate)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[产品证书(PRODUCT_CERTIFICATE)](module/crm/product_certificate)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[产品证书(PRODUCT_CERTIFICATE)](module/crm/product_certificate)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[产品证书(PRODUCT_CERTIFICATE)](module/crm/product_certificate)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[订单(PROJECT)](module/crm/project)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[订单(PROJECT)](module/crm/project)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[订单(PROJECT)](module/crm/project)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[订单(PROJECT)](module/crm/project)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[订单(PROJECT)](module/crm/project)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|树表格(tree)|[订单(PROJECT)](module/crm/project)|PSDEDataSetImpl|[TreeGridDEDataSetRuntime](#UsrSFPlugin0407757309)||
|批添加标签(add_tags)|[采购订单(PURCHASE_ORDER)](module/crm/purchase_order)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[采购订单(PURCHASE_ORDER)](module/crm/purchase_order)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[采购订单(PURCHASE_ORDER)](module/crm/purchase_order)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[采购订单(PURCHASE_ORDER)](module/crm/purchase_order)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[采购订单(PURCHASE_ORDER)](module/crm/purchase_order)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[报价(QUOTE)](module/crm/quote)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[报价(QUOTE)](module/crm/quote)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[报价(QUOTE)](module/crm/quote)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[报价(QUOTE)](module/crm/quote)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[报价(QUOTE)](module/crm/quote)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[销售订单(SALES_ORDER)](module/crm/sales_order)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[销售订单(SALES_ORDER)](module/crm/sales_order)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[销售订单(SALES_ORDER)](module/crm/sales_order)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[销售订单(SALES_ORDER)](module/crm/sales_order)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[销售订单(SALES_ORDER)](module/crm/sales_order)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|Get|[日程(SCHEDULE)](module/crm/schedule)|PSDEBuiltinActionImpl|[（通用）获取并生成最近访问](#GetAndCreateRecent)||
|批添加标签(add_tags)|[解决方案(SOLUTION)](module/crm/solution)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[解决方案(SOLUTION)](module/crm/solution)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[解决方案(SOLUTION)](module/crm/solution)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[解决方案(SOLUTION)](module/crm/solution)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[解决方案(SOLUTION)](module/crm/solution)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[任务&活动(TASK)](module/crm/task)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[任务&活动(TASK)](module/crm/task)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[任务&活动(TASK)](module/crm/task)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[任务&活动(TASK)](module/crm/task)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[任务&活动(TASK)](module/crm/task)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||
|批添加标签(add_tags)|[供应商(VENDOR)](module/crm/vendor)|PSDEUserCustomActionImpl|[（通用）添加标签](#AddTags)||
|批更新(batch_update)|[供应商(VENDOR)](module/crm/vendor)|PSDEUserCustomActionImpl|[（通用）更新](#Update)||
|批创建任务(create_task)|[供应商(VENDOR)](module/crm/vendor)|PSDEUserCustomActionImpl|[（通用）创建任务](#CreateTask)||
|批移除标签(delete_tags)|[供应商(VENDOR)](module/crm/vendor)|PSDEUserCustomActionImpl|[（通用）移除标签](#RemoveTags)||
|main_view_dr计数器(main_view_dr_count)|[供应商(VENDOR)](module/crm/vendor)|PSDEUserCustomActionImpl|[（通用）main_view关系计数器](#UsrSFPlugin0321285737)||

### （通用）添加标签 :id=AddTags


```cn.ibizlab.plugin.action.AddTags```

```groovy
package cn.ibizlab.plugin.action

import net.ibizsys.central.dataentity.action.DEActionRuntimeBase
import net.ibizsys.central.util.IEntityDTO

/**
 * （通用）添加标签
 *
 * @author xignzi
 * @date 2024/3/19
 */
class AddTags extends DEActionRuntimeBase {

    @Override
    protected Object onExecute(IEntityDTO iEntityDTO) throws Throwable {
        return iEntityDTO
    }

}

```
### （通用）创建任务 :id=CreateTask


```cn.ibizlab.plugin.action.CreateTask```

```groovy
package cn.ibizlab.plugin.action

import net.ibizsys.central.dataentity.IDataEntityRuntime
import net.ibizsys.central.dataentity.action.DEActionRuntimeBase
import net.ibizsys.central.util.IEntityDTO

/**
 * （通用）创建任务
 *
 * @author xignzi
 * @date 2024/3/19
 */
class CreateTask extends DEActionRuntimeBase {

    @Override
    protected Object onExecute(IEntityDTO iEntityDTO) throws Throwable {
        Object key = this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO)
        if (!key)
            return
        List params = iEntityDTO.get("srfactionparam")
        if (params) {
            IDataEntityRuntime iDataEntityRuntime = this.getSystemRuntime().getDataEntityRuntime("TASK")
            for (Map param  : params) {
                IEntityDTO task = iDataEntityRuntime.createEntity()
                task.reload(param,false)
                task.put("owner_type",this.getDataEntityRuntime().getName())
                task.put("owner_id",key)
                iDataEntityRuntime.create(task)
            }
        }
        return iEntityDTO
    }

}

```
### （通用）获取并生成最近访问 :id=GetAndCreateRecent


```cn.ibizlab.plugin.action.GetAndCreateRecent```

```groovy
package cn.ibizlab.plugin.action

import net.ibizsys.central.dataentity.IDataEntityRuntime
import net.ibizsys.central.dataentity.action.DEActionRuntimeBase
import net.ibizsys.central.util.IEntityDTO
import net.ibizsys.runtime.security.UserContext
import org.apache.commons.logging.Log
import org.apache.commons.logging.LogFactory

/**
 * 获取并生成最近访问
 *
 * @author xignzi
 * @date 2024/3/18
 */
public class GetAndCreateRecent extends DEActionRuntimeBase {

    private static final Log log = LogFactory.getLog(GetAndCreateRecent.class)

    @Override
    protected Object onExecute(IEntityDTO iEntityDTO) throws Throwable {
        IDataEntityRuntime iDataEntityRuntime = this.getDataEntityRuntime()
        iEntityDTO = iDataEntityRuntime.getSimpleEntity(iDataEntityRuntime.getKeyFieldValue(iEntityDTO))

//        createRecent(iEntityDTO)

        return iEntityDTO;
    }

    @Override
    protected Object onExecute(Object arg) throws Throwable {
        IDataEntityRuntime iDataEntityRuntime = this.getDataEntityRuntime()
        IEntityDTO iEntityDTO = iDataEntityRuntime.getSimpleEntity(arg)

        createRecent(iEntityDTO)

        return iEntityDTO;
    }


    protected void createRecent(IEntityDTO iEntityDTO) {
        IDataEntityRuntime iDataEntityRuntime = this.getDataEntityRuntime()
        try {
            IDataEntityRuntime recentDataEntityRuntime = this.getSystemRuntime().getDataEntityRuntime("RECENT")
            IEntityDTO recent = recentDataEntityRuntime.createEntity()
            recent.set("OWNER_ID", iDataEntityRuntime.getKeyFieldValue(iEntityDTO))
            recent.set("OWNER_TYPE", iDataEntityRuntime.getName())
            recent.set("OWNER_SUBTYPE", iDataEntityRuntime.getName())
            recent.set("CREATE_MAN", UserContext.getCurrent().getUserid())
            recent.set("TYPE", "2")
            recent.set(recentDataEntityRuntime.getMajorPSDEField().getName(), iDataEntityRuntime.getFieldValue(iEntityDTO, iDataEntityRuntime.getMajorPSDEField()))
            recentDataEntityRuntime.executeAction("Save", null, [recent])
        } catch (Throwable e) {
            log.error(String.format("生成[%s]最近访问失败：主键[%s]", iDataEntityRuntime.getName(), iEntityDTO.get(iDataEntityRuntime.getKeyNamePSDEField().getName())))
        }
    }

}

```
### （通用）移除标签 :id=RemoveTags


```cn.ibizlab.plugin.action.RemoveTags```

```groovy
package cn.ibizlab.plugin.action

import net.ibizsys.central.dataentity.action.DEActionRuntimeBase
import net.ibizsys.central.util.IEntityDTO

/**
 * （通用）移除标签
 *
 * @author xignzi
 * @date 2024/3/19
 */
class RemoveTags extends DEActionRuntimeBase {

    @Override
    protected Object onExecute(IEntityDTO iEntityDTO) throws Throwable {
        return iEntityDTO
    }

}

```
### （通用）更新 :id=Update


```cn.ibizlab.plugin.action.Update```

```groovy
package cn.ibizlab.plugin.action

import net.ibizsys.central.dataentity.action.DEActionRuntimeBase
import net.ibizsys.central.util.IEntityDTO

/**
 * （通用）更新
 *
 * @author xignzi
 * @date 2024/3/19
 */
class Update extends DEActionRuntimeBase {

    @Override
    protected Object onExecute(IEntityDTO iEntityDTO) throws Throwable {
        return iEntityDTO
    }

}

```
### SysAtContentTranslatorRuntime :id=UsrSFPlugin0201416283


```net.ibizsys.central.res.SysAtContentTranslatorRuntime```

```groovy
null
```
### （通用）main_view关系计数器 :id=UsrSFPlugin0321285737


```cn.ibizlab.plugin.action.MainViewDRCount```

```groovy
package cn.ibizlab.plugin.action

import net.ibizsys.central.cloud.core.dataentity.IDataEntityRuntime
import net.ibizsys.central.dataentity.action.DEActionRuntimeBase
import net.ibizsys.central.util.IEntityDTO
import net.ibizsys.central.util.SearchContextDTO
import org.springframework.data.domain.Page

/**
 * （通用）main_view关系计数器
 *
 * @author xignzi
 * @date 2024/3/19
 */
class MainViewDRCount extends DEActionRuntimeBase {

    @Override
    protected Object onExecute(IEntityDTO iEntityDTO) throws Throwable {
        SearchContextDTO ctx
        Page page
        Object[] args
        //进展评估
        IDataEntityRuntime NOTE_ATTACHRuntime = this.getSystemRuntime().getDataEntityRuntime('NOTE_ATTACH', true)
        ctx = NOTE_ATTACHRuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.eq("PRINCIPAL_ID", this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        ctx.eq("OWNER_TYPE", this.getDataEntityRuntime().getName())
        args = [ctx]
        page = NOTE_ATTACHRuntime.fetchDataSet("DEFAULT", null, args)
        iEntityDTO.put("note_attach", page.getTotalElements())

        //附件
        IDataEntityRuntime ATTACHMENTRuntime = this.getSystemRuntime().getDataEntityRuntime('ATTACHMENT', true)
        ctx = ATTACHMENTRuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.eq("OWNER_ID", this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        ctx.eq("OWNER_TYPE", this.getDataEntityRuntime().getName())
        args = [ctx]
        page = ATTACHMENTRuntime.fetchDataSet("DEFAULT", null, args)
        iEntityDTO.put("attachment", page.getTotalElements())

        //待办任务
        IDataEntityRuntime TASKRuntime = this.getSystemRuntime().getDataEntityRuntime('TASK', true)
        ctx = TASKRuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.set("PRINCIPAL_ID",this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        args = [ctx]
        page = TASKRuntime.fetchDataSet("not_close_task_related", null, args)
        iEntityDTO.put("not_close", page.getTotalElements())

        //已完成的任务
        page = TASKRuntime.fetchDataSet("close_task_related", null, args)
        iEntityDTO.put("finishtask", page.getTotalElements())

        //历史活动
        page = TASKRuntime.fetchDataSet("maneuver_related", null, args)
        iEntityDTO.put("hisact", page.getTotalElements())

        //已完成的任务和历史活动
        page = TASKRuntime.fetchDataSet("maneuver_task_related", null, args)
        iEntityDTO.put("taskhisact", page.getTotalElements())

        //产品
        IDataEntityRuntime PRODUCTRuntime = this.getSystemRuntime().getDataEntityRuntime('PRODUCT', true)
        ctx = PRODUCTRuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.set("PRINCIPAL_ID",this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        ctx.set("PRINCIPAL_TYPE","DEAL")
        args = [ctx]
        page = PRODUCTRuntime.fetchDataSet("relation_target", null, args)
        iEntityDTO.put("product", page.getTotalElements())

        //联系人
        IDataEntityRuntime CONTACTRuntime = this.getSystemRuntime().getDataEntityRuntime('CONTACT', true)
        ctx = CONTACTRuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.eq("ACCOUNT_ID", this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        args = [ctx]
        page = CONTACTRuntime.fetchDataSet("DEFAULT", null, args)
        iEntityDTO.put("contact", page.getTotalElements())

        //关联销售人员
        IDataEntityRuntime USERRuntime = this.getSystemRuntime().getDataEntityRuntime('USER', true)
        ctx = USERRuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.set("PRINCIPAL_ID",this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        args = [ctx]
        page = USERRuntime.fetchDataSet("account_reluser", null, args)
        iEntityDTO.put("user", page.getTotalElements())


        //商机-客户
        IDataEntityRuntime DEALRuntime = this.getSystemRuntime().getDataEntityRuntime('DEAL', true)
        ctx = DEALRuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.set("PRINCIPAL_ID",this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        ctx.set("PRINCIPAL_TYPE","ACCOUNT")
        args = [ctx]
        page = DEALRuntime.fetchDataSet("target_relation", null, args)
        iEntityDTO.put("deal", page.getTotalElements())

        //商机-产品
        IDataEntityRuntime DEALPRORuntime = this.getSystemRuntime().getDataEntityRuntime('DEAL', true)
        ctx = DEALPRORuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.set("PRINCIPAL_ID",this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        ctx.set("PRINCIPAL_TYPE","PRODUCT")
        args = [ctx]
        page = DEALPRORuntime.fetchDataSet("target_relation", null, args)
        iEntityDTO.put("deal_product", page.getTotalElements())

        //产品证书
        IDataEntityRuntime PRODUCTCERTIFICATERuntime = this.getSystemRuntime().getDataEntityRuntime('PRODUCT_CERTIFICATE', true)
        ctx = PRODUCTCERTIFICATERuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.eq("PRODUCT_ID", this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        args = [ctx]
        page = PRODUCTCERTIFICATERuntime.fetchDataSet("DEFAULT", null, args)
        iEntityDTO.put("certificate", page.getTotalElements())

        //阶段历史
        IDataEntityRuntime DEALHISRuntime = this.getSystemRuntime().getDataEntityRuntime('DEAL_HISTORY', true)
        ctx = DEALHISRuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.eq("DEAL_ID",this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        args = [ctx]
        page = DEALHISRuntime.fetchDataSet("DEFAULT", null, args)
        iEntityDTO.put("dealhis", page.getTotalElements())

        //线索-产品
        IDataEntityRuntime LEADPRORuntime = this.getSystemRuntime().getDataEntityRuntime('PRODUCT', true)
        ctx = LEADPRORuntime.createSearchContext()
        ctx.setPageable(1, 1, 0)
        ctx.set("PRINCIPAL_ID",this.getDataEntityRuntime().getKeyFieldValue(iEntityDTO))
        ctx.set("PRINCIPAL_TYPE","LEAD")
        args = [ctx]
        page = LEADPRORuntime.fetchDataSet("relation_target", null, args)
        iEntityDTO.put("lead_product", page.getTotalElements())

        return iEntityDTO
    }

}

```
### TreeGridDEDataSetRuntime :id=UsrSFPlugin0407757309


```net.ibizsys.central.plugin.util.dataentity.ds.TreeGridDEDataSetRuntime```

```groovy
null
```






