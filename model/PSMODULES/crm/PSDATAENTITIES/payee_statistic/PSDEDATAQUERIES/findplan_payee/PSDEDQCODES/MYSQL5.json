{
  "dBType" : "MYSQL5",
  "name" : "MySQL5",
  "queryCode" : "SELECT T1.* FROM (\nSELECT T2.O_NUMBER,T2.NAME AS PROJECT_NAME,T3.ACCOUNT_NAME,T2.BUSINESS_LINE,'0' AS TYPE,T1.AMOUNT,T1.PLANNED_TIME AS STATISTIC_DATE,T2.OWNER,T1.DESCRIPTION,T1.ID AS ID,T2.ID AS PROJECT_ID FROM PAYEE_PLAN T1,PROJECT T2,ACCOUNT T3\nWHERE T1.PROJECT_ID = T2.ID AND T2.ACCOUNT_ID = T3.ID AND '0' = #{ctx.datacontext.type} AND T1.PLANNED_TIME IS NULL AND T1.PLAN_STATUS = '10'\nUNION ALL\n\nSELECT T2.O_NUMBER,T2.NAME AS PROJECT_NAME,T3.ACCOUNT_NAME,T2.BUSINESS_LINE,'2' AS TYPE,T1.AMOUNT,T1.PLANNED_TIME AS STATISTIC_DATE,T2.OWNER,T1.DESCRIPTION,T1.ID AS ID,T2.ID AS PROJECT_ID FROM PAYEE_PLAN T1,PROJECT T2,ACCOUNT T3\nWHERE T1.PROJECT_ID = T2.ID AND T2.ACCOUNT_ID = T3.ID AND '2' = #{ctx.datacontext.type} AND CONCAT(YEAR(T1.PLANNED_TIME),'-',LPAD(MONTH(T1.PLANNED_TIME), 2, '0')) = #{ctx.datacontext.name} AND T1.PLAN_STATUS = '10'\nUNION ALL\n\nSELECT T2.O_NUMBER,T2.NAME AS PROJECT_NAME,T3.ACCOUNT_NAME,T2.BUSINESS_LINE,'1' AS TYPE,T1.AMOUNT,T1.PAYEE_DATE AS STATISTIC_DATE,T2.OWNER,T1.DESCRIPTION,T1.ID AS ID,T2.ID AS PROJECT_ID FROM PAYEE T1,PROJECT T2,ACCOUNT T3\nWHERE T1.PROJECT_ID = T2.ID AND T2.ACCOUNT_ID = T3.ID AND '1' = #{ctx.datacontext.type} AND CONCAT(YEAR(T1.PAYEE_DATE),'-',LPAD(MONTH(T1.PAYEE_DATE), 2, '0')) = #{ctx.datacontext.name} \nUNION ALL\n\nSELECT T2.O_NUMBER,T2.NAME AS PROJECT_NAME,T3.ACCOUNT_NAME,T2.BUSINESS_LINE,'3' AS TYPE,T1.AMOUNT,T1.PLANNED_TIME AS STATISTIC_DATE,T2.OWNER,T1.DESCRIPTION,T1.ID AS ID,T2.ID AS PROJECT_ID FROM PAYEE_PLAN T1,PROJECT T2,ACCOUNT T3\nWHERE T1.PROJECT_ID = T2.ID AND T2.ACCOUNT_ID = T3.ID AND '3' = #{ctx.datacontext.type} AND T1.PLANNED_TIME > STR_TO_DATE(CONCAT(#{ctx.datacontext.lt},'-01'), '%Y-%m-%d') AND T1.PLAN_STATUS = '10'\nUNION ALL\n\nSELECT T2.O_NUMBER,T2.NAME AS PROJECT_NAME,T3.ACCOUNT_NAME,T2.BUSINESS_LINE,'1' AS TYPE,T1.AMOUNT,T1.PAYEE_DATE AS STATISTIC_DATE,T2.OWNER,T1.DESCRIPTION,T1.ID AS ID,T2.ID AS PROJECT_ID FROM PAYEE T1,PROJECT T2,ACCOUNT T3\nWHERE T1.PROJECT_ID = T2.ID AND T2.ACCOUNT_ID = T3.ID AND '3' = #{ctx.datacontext.type} AND T1.PAYEE_DATE > STR_TO_DATE(CONCAT(#{ctx.datacontext.lt},'-01'), '%Y-%m-%d')\n\n) T1",
  "id" : "PSMODULES/crm/PSDATAENTITIES/payee_statistic/PSDEDATAQUERIES/findplan_payee/PSDEDQCODES/MYSQL5.json"
}